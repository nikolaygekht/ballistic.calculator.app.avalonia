<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:DebugApp.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:controls="using:BallisticCalculator.Controls.Controls"
        xmlns:gehtsoft="using:Gehtsoft.Measurements"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
        x:Class="DebugApp.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="BallisticCalculator Debug App"
        Width="900" Height="700">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <TabControl>
      <!-- Ballistic Coefficient Tab -->
      <TabItem Header="Ballistic Coefficient">
        <ScrollViewer>
          <StackPanel Margin="20" Spacing="15">

            <!-- Title -->
            <TextBlock Text="BallisticCoefficientControl Test"
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>

            <!-- Basic Test -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Basic Usage" FontWeight="Bold" />

                <TextBlock Text="Ballistic Coefficient:" />
                <controls:BallisticCoefficientControl
                    x:Name="BasicBC"
                    Width="300"
                    HorizontalAlignment="Left" />

                <TextBlock x:Name="BasicBCChangeCounter"
                           Text="Changed events: 0"
                           FontSize="11"
                           Foreground="DarkBlue"
                           FontStyle="Italic" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="Set 0.450 G1" Click="OnSetBasicBC" />
                  <Button Content="Get Value" Click="OnGetBasicBC" />
                  <Button Content="Clear" Click="OnClearBC" />
                </StackPanel>

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="BasicBCDisplay"
                             Text="Value: (none)"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Precision Transparency Test (CRITICAL) -->
            <Border BorderBrush="DarkOrange" BorderThickness="2" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="⭐ Precision Transparency Test"
                           FontWeight="Bold" 
                           Foreground="DarkOrange" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="Critical test: Set value with 5 decimals (0.45678), control displays 3 decimals (0.457)." />
                  <LineBreak />
                  <Run Text="Without editing, getting value back should return EXACT original (0.45678)." FontWeight="Bold" />
                </TextBlock>

                <controls:BallisticCoefficientControl
                    x:Name="PrecisionBC"
                    DecimalPoints="3"
                    Width="300"
                    HorizontalAlignment="Left" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="1. Set 0.45678" Click="OnSetPrecisionBC" />
                  <Button Content="2. Get Value" Click="OnGetPrecisionBC" />
                </StackPanel>

                <Border Background="LightYellow" Padding="10" CornerRadius="3">
                  <StackPanel Spacing="5">
                    <TextBlock x:Name="PrecisionResult"
                               Text="Test result: Click buttons in order"
                               FontWeight="Bold"
                               TextWrapping="Wrap" />
                    <TextBlock x:Name="PrecisionDetails"
                               Text=""
                               TextWrapping="Wrap" />
                  </StackPanel>
                </Border>
              </StackPanel>
            </Border>

            <!-- Drag Tables Order Test -->
            <Border BorderBrush="Blue" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Drag Tables Order Test" FontWeight="Bold" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="Expected order: " />
                  <Run Text="G1, G2, G5, G6, G7, G8, GI, GS, RA4, GC" FontWeight="Bold" />
                </TextBlock>

                <controls:BallisticCoefficientControl
                    x:Name="TablesBC"
                    Width="300"
                    HorizontalAlignment="Left" />

                <Button Content="Verify Tables Order" Click="OnVerifyTables" />

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="TablesDisplay"
                             Text="Click button to verify"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Keyboard Navigation Test -->
            <Border BorderBrush="Green" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Keyboard Navigation Test" FontWeight="Bold" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="Test:" />
                  <LineBreak />
                  <Run Text="• Tab into control → NumericPart gets focus" />
                  <LineBreak />
                  <Run Text="• Tab again → TablePart gets focus" />
                  <LineBreak />
                  <Run Text="• Up/Down arrows in NumericPart → increment/decrement" />
                </TextBlock>

                <controls:BallisticCoefficientControl
                    x:Name="KeyboardBC"
                    Width="300"
                    Increment="0.010"
                    HorizontalAlignment="Left" />

                <TextBlock Text="Increment: 0.010" FontStyle="Italic" />
              </StackPanel>
            </Border>

            <!-- Min/Max Test -->
            <Border BorderBrush="Red" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Min/Max Validation Test" FontWeight="Bold" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="Min: 0.100, Max: 1.000" FontWeight="Bold" />
                  <LineBreak />
                  <Run Text="Try entering values outside this range or use arrows at boundaries." />
                </TextBlock>

                <controls:BallisticCoefficientControl
                    x:Name="ValidationBC"
                    Minimum="0.100"
                    Maximum="1.000"
                    Width="300"
                    HorizontalAlignment="Left" />

                <TextBlock Text="Validation errors will appear below the control (mobile-friendly inline validation)."
                           FontStyle="Italic" />
              </StackPanel>
            </Border>

            <!-- Sizing Test -->
            <Border BorderBrush="Purple" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Sizing Test" FontWeight="Bold" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="TablePartWidth can be configured. Default: 80px" />
                </TextBlock>

                <TextBlock Text="Default (80px):" />
                <controls:BallisticCoefficientControl
                    x:Name="SizingBC1"
                    Width="300"
                    HorizontalAlignment="Stretch" />

                <TextBlock Text="Custom (120px):" />
                <controls:BallisticCoefficientControl
                    x:Name="SizingBC2"
                    TablePartWidth="120"
                    Width="300"
                    HorizontalAlignment="Stretch" />
              </StackPanel>
            </Border>

          </StackPanel>
        </ScrollViewer>
      </TabItem>

      <!-- Measurement Control Tab -->
      <TabItem Header="Measurement Control">
        <ScrollViewer>
          <StackPanel Margin="20" Spacing="15">

            <!-- Title -->
            <TextBlock Text="MeasurementControl Test"
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>

            <!-- Distance Test -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Distance Measurement" FontWeight="Bold" />

                <TextBlock Text="Distance (meters, feet, yards, etc.):" />
                <controls:MeasurementControl
                    x:Name="DistanceControl"
                    UnitType="{x:Type gehtsoft:DistanceUnit}"
                    DecimalPoints="2"
                    Width="300"
                    HorizontalAlignment="Left" />

                <TextBlock x:Name="DistanceChangeCounter"
                           Text="Changed events: 0"
                           FontSize="11"
                           Foreground="DarkBlue"
                           FontStyle="Italic" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="Set 100m" Click="OnSetDistance" />
                  <Button Content="Get Value" Click="OnGetDistance" />
                  <Button Content="Clear" Click="OnClearDistance" />
                </StackPanel>

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="DistanceDisplay"
                             Text="Value: (none)"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Velocity Test -->
            <Border BorderBrush="Blue" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Velocity Measurement" FontWeight="Bold" />

                <TextBlock Text="Velocity (m/s, ft/s, km/h, mph):" />
                <controls:MeasurementControl
                    x:Name="VelocityControl"
                    UnitType="{x:Type gehtsoft:VelocityUnit}"
                    DecimalPoints="1"
                    Width="300"
                    HorizontalAlignment="Left" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="Set 800 m/s" Click="OnSetVelocity" />
                  <Button Content="Get Value" Click="OnGetVelocity" />
                </StackPanel>

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="VelocityDisplay"
                             Text="Value: (none)"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Weight Test -->
            <Border BorderBrush="Green" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Weight Measurement" FontWeight="Bold" />

                <TextBlock Text="Weight (grains, grams, ounces, pounds):" />
                <controls:MeasurementControl
                    x:Name="WeightControl"
                    UnitType="{x:Type gehtsoft:WeightUnit}"
                    DecimalPoints="1"
                    Width="300"
                    HorizontalAlignment="Left" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="Set 150 gr" Click="OnSetWeight" />
                  <Button Content="Get Value" Click="OnGetWeight" />
                </StackPanel>

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="WeightDisplay"
                             Text="Value: (none)"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Unit Conversion Test -->
            <Border BorderBrush="Orange" BorderThickness="2" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="⭐ Unit Conversion Test" FontWeight="Bold" Foreground="DarkOrange" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="Test ChangeUnit() method: Set 100 meters, convert to feet." />
                </TextBlock>

                <controls:MeasurementControl
                    x:Name="ConversionControl"
                    UnitType="{x:Type gehtsoft:DistanceUnit}"
                    DecimalPoints="2"
                    Width="300"
                    HorizontalAlignment="Left" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="1. Set 100m" Click="OnSetForConversion" />
                  <Button Content="2. Convert to Feet" Click="OnConvertToFeet" />
                  <Button Content="3. Get Value" Click="OnGetConverted" />
                </StackPanel>

                <Border Background="LightYellow" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="ConversionDisplay"
                             Text="Result: Click buttons in order"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

          </StackPanel>
        </ScrollViewer>
      </TabItem>

      <!-- Reticle Canvas Tab -->
      <TabItem Header="Reticle Canvas">
        <ScrollViewer>
          <StackPanel Margin="20" Spacing="15">

            <!-- Title -->
            <TextBlock Text="ReticleCanvasControl Test"
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>

            <!-- Basic Reticle Test -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Reticle File Viewer" FontWeight="Bold" />

                <TextBlock Text="Reticle Canvas:" />
                <controls:ReticleCanvasControl
                    x:Name="ReticleCanvas"
                    Width="600"
                    Height="600"
                    BackgroundColor="White"
                    HorizontalAlignment="Left" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="Load Reticle..." Click="OnLoadReticle" />
                  <Button Content="Clear" Click="OnClearReticle" />
                </StackPanel>

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="ReticleDisplay"
                             Text="No reticle loaded"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Background Color Test -->
            <Border BorderBrush="Green" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Background Color" FontWeight="Bold" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="White Background" Click="OnSetBgWhite" />
                  <Button Content="Black Background" Click="OnSetBgBlack" />
                  <Button Content="Gray Background" Click="OnSetBgGray" />
                </StackPanel>
              </StackPanel>
            </Border>

          </StackPanel>
        </ScrollViewer>
      </TabItem>

      <!-- Wind Direction Control Tab -->
      <TabItem Header="Wind Direction">
        <ScrollViewer>
          <StackPanel Margin="20" Spacing="15">

            <!-- Title -->
            <TextBlock Text="WindDirectionControl Test"
                       FontWeight="Bold"
                       Margin="0,0,0,10"/>

            <!-- Basic Test -->
            <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Basic Usage" FontWeight="Bold" />

                <TextBlock TextWrapping="Wrap">
                  <Run Text="Click or drag on the circle to set wind direction." />
                  <LineBreak />
                  <Run Text="Arrow shows where wind comes FROM (toward shooter at center)." />
                </TextBlock>

                <controls:WindDirectionControl
                    x:Name="WindControl"
                    Width="150"
                    Height="150"
                    StrokeThickness="2"
                    HorizontalAlignment="Left" />

                <TextBlock x:Name="WindChangeCounter"
                           Text="Changed events: 0"
                           FontSize="11"
                           Foreground="DarkBlue"
                           FontStyle="Italic" />

                <Border Background="LightGray" Padding="10" CornerRadius="3">
                  <TextBlock x:Name="WindDisplay"
                             Text="Direction: 0°"
                             TextWrapping="Wrap" />
                </Border>
              </StackPanel>
            </Border>

            <!-- Preset Values Test -->
            <Border BorderBrush="Blue" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Preset Values" FontWeight="Bold" />

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="0° (Tailwind)" Click="OnSetWind0" />
                  <Button Content="90° (From Right)" Click="OnSetWind90" />
                  <Button Content="180° (Headwind)" Click="OnSetWind180" />
                  <Button Content="270° (From Left)" Click="OnSetWind270" />
                </StackPanel>

                <StackPanel Orientation="Horizontal" Spacing="10">
                  <Button Content="45°" Click="OnSetWind45" />
                  <Button Content="135°" Click="OnSetWind135" />
                  <Button Content="225°" Click="OnSetWind225" />
                  <Button Content="315°" Click="OnSetWind315" />
                </StackPanel>
              </StackPanel>
            </Border>

            <!-- Styling Test -->
            <Border BorderBrush="Green" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Styling Test" FontWeight="Bold" />

                <TextBlock Text="Different stroke colors and thickness:" />

                <StackPanel Orientation="Horizontal" Spacing="20">
                  <StackPanel Spacing="5">
                    <TextBlock Text="Red, thick (4px)" />
                    <controls:WindDirectionControl
                        x:Name="WindControlRed"
                        Width="100"
                        Height="100"
                        StrokeBrush="Red"
                        StrokeThickness="4" />
                  </StackPanel>

                  <StackPanel Spacing="5">
                    <TextBlock Text="Blue, thin (1px)" />
                    <controls:WindDirectionControl
                        x:Name="WindControlBlue"
                        Width="100"
                        Height="100"
                        StrokeBrush="Blue"
                        StrokeThickness="1" />
                  </StackPanel>

                  <StackPanel Spacing="5">
                    <TextBlock Text="Green, medium (2px)" />
                    <controls:WindDirectionControl
                        x:Name="WindControlGreen"
                        Width="100"
                        Height="100"
                        StrokeBrush="Green"
                        StrokeThickness="2" />
                  </StackPanel>
                </StackPanel>
              </StackPanel>
            </Border>

            <!-- Size Test -->
            <Border BorderBrush="Purple" BorderThickness="1" Padding="15" CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock Text="Size Test" FontWeight="Bold" />

                <TextBlock Text="Different sizes:" />

                <StackPanel Orientation="Horizontal" Spacing="20" VerticalAlignment="Bottom">
                  <StackPanel Spacing="5">
                    <TextBlock Text="50x50" />
                    <controls:WindDirectionControl
                        Width="50"
                        Height="50"
                        StrokeThickness="1" />
                  </StackPanel>

                  <StackPanel Spacing="5">
                    <TextBlock Text="100x100" />
                    <controls:WindDirectionControl
                        Width="100"
                        Height="100"
                        StrokeThickness="2" />
                  </StackPanel>

                  <StackPanel Spacing="5">
                    <TextBlock Text="150x150" />
                    <controls:WindDirectionControl
                        Width="150"
                        Height="150"
                        StrokeThickness="2" />
                  </StackPanel>
                </StackPanel>
              </StackPanel>
            </Border>

          </StackPanel>
        </ScrollViewer>
      </TabItem>

      <!-- Trajectory Chart Tab -->
      <TabItem Header="Trajectory Chart">
        <Grid RowDefinitions="Auto,*,Auto">
          <!-- Controls Row -->
          <StackPanel Grid.Row="0" Margin="10" Spacing="10">
            <TextBlock Text="TrajectoryChartControl Test"
                       FontWeight="Bold"
                       Margin="0,0,0,5"/>

            <!-- Chart Mode Selection -->
            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="Chart Mode:" VerticalAlignment="Center" />
              <ComboBox x:Name="ChartModeCombo"
                        Width="150"
                        SelectedIndex="2"
                        SelectionChanged="OnChartModeChanged">
                <ComboBoxItem Content="Velocity" />
                <ComboBoxItem Content="Mach" />
                <ComboBoxItem Content="Drop" />
                <ComboBoxItem Content="Drop Adjustment" />
                <ComboBoxItem Content="Windage" />
                <ComboBoxItem Content="Windage Adjustment" />
                <ComboBoxItem Content="Energy" />
              </ComboBox>

              <TextBlock Text="Units:" VerticalAlignment="Center" Margin="20,0,0,0" />
              <ComboBox x:Name="MeasurementSystemCombo"
                        Width="100"
                        SelectedIndex="0"
                        SelectionChanged="OnMeasurementSystemChanged">
                <ComboBoxItem Content="Metric" />
                <ComboBoxItem Content="Imperial" />
              </ComboBox>

              <TextBlock Text="Angular:" VerticalAlignment="Center" Margin="20,0,0,0" />
              <ComboBox x:Name="AngularUnitCombo"
                        Width="80"
                        SelectedIndex="0"
                        SelectionChanged="OnAngularUnitChanged">
                <ComboBoxItem Content="MOA" />
                <ComboBoxItem Content="MRad" />
                <ComboBoxItem Content="Mil" />
              </ComboBox>
            </StackPanel>

            <!-- Drop Base Selection (only relevant for Drop mode) -->
            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="Drop Base:" VerticalAlignment="Center" />
              <ComboBox x:Name="DropBaseCombo"
                        Width="120"
                        SelectedIndex="0"
                        SelectionChanged="OnDropBaseChanged">
                <ComboBoxItem Content="Sight Line" />
                <ComboBoxItem Content="Muzzle Point" />
              </ComboBox>

              <TextBlock Text="(Only affects Drop mode)"
                         VerticalAlignment="Center"
                         FontStyle="Italic"
                         Foreground="Gray" />
            </StackPanel>

            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" Spacing="10">
              <Button Content="Load Sample Trajectory" Click="OnLoadSampleTrajectory" />
              <Button Content="Add Second Trajectory" Click="OnAddSecondTrajectory" />
              <Button Content="Clear All" Click="OnClearTrajectories" />
              <TextBlock x:Name="TrajectoryCountDisplay"
                         Text="Trajectories: 0"
                         VerticalAlignment="Center"
                         Margin="20,0,0,0" />
            </StackPanel>
          </StackPanel>

          <!-- Chart -->
          <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Margin="10,0,10,10">
            <controls:TrajectoryChartControl x:Name="TrajectoryChart" />
          </Border>

          <!-- Info Panel -->
          <Border Grid.Row="2" Background="LightGray" Padding="10" Margin="10,0,10,10">
            <TextBlock x:Name="ChartInfoDisplay"
                       Text="Click 'Load Sample Trajectory' to display a chart."
                       TextWrapping="Wrap" />
          </Border>
        </Grid>
      </TabItem>

      <!-- Trajectory Table Tab -->
      <TabItem Header="Trajectory Table">
        <Grid RowDefinitions="Auto,*,Auto">
          <!-- Controls Row -->
          <StackPanel Grid.Row="0" Margin="10" Spacing="10">
            <TextBlock Text="TrajectoryTableControl Test"
                       FontWeight="Bold"
                       Margin="0,0,0,5"/>

            <!-- Unit Selection -->
            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="Units:" VerticalAlignment="Center" />
              <ComboBox x:Name="TableMeasurementSystemCombo"
                        Width="100"
                        SelectedIndex="0"
                        SelectionChanged="OnTableMeasurementSystemChanged">
                <ComboBoxItem Content="Metric" />
                <ComboBoxItem Content="Imperial" />
              </ComboBox>

              <TextBlock Text="Angular:" VerticalAlignment="Center" Margin="20,0,0,0" />
              <ComboBox x:Name="TableAngularUnitCombo"
                        Width="80"
                        SelectedIndex="0"
                        SelectionChanged="OnTableAngularUnitChanged">
                <ComboBoxItem Content="MOA" />
                <ComboBoxItem Content="MRad" />
                <ComboBoxItem Content="Mil" />
              </ComboBox>

              <TextBlock Text="Drop Base:" VerticalAlignment="Center" Margin="20,0,0,0" />
              <ComboBox x:Name="TableDropBaseCombo"
                        Width="120"
                        SelectedIndex="0"
                        SelectionChanged="OnTableDropBaseChanged">
                <ComboBoxItem Content="Sight Line" />
                <ComboBoxItem Content="Muzzle Point" />
              </ComboBox>
            </StackPanel>

            <!-- Click Size Settings -->
            <StackPanel Orientation="Horizontal" Spacing="10">
              <TextBlock Text="Vertical Click:" VerticalAlignment="Center" />
              <ComboBox x:Name="VerticalClickCombo"
                        Width="100"
                        SelectedIndex="1"
                        SelectionChanged="OnVerticalClickChanged">
                <ComboBoxItem Content="None" />
                <ComboBoxItem Content="1/4 MOA" />
                <ComboBoxItem Content="1/8 MOA" />
                <ComboBoxItem Content="0.1 MRad" />
              </ComboBox>

              <TextBlock Text="Horizontal Click:" VerticalAlignment="Center" Margin="20,0,0,0" />
              <ComboBox x:Name="HorizontalClickCombo"
                        Width="100"
                        SelectedIndex="1"
                        SelectionChanged="OnHorizontalClickChanged">
                <ComboBoxItem Content="None" />
                <ComboBoxItem Content="1/4 MOA" />
                <ComboBoxItem Content="1/8 MOA" />
                <ComboBoxItem Content="0.1 MRad" />
              </ComboBox>
            </StackPanel>

            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" Spacing="10">
              <Button Content="Load Sample Trajectory" Click="OnLoadTableTrajectory" />
              <Button Content="Clear" Click="OnClearTableTrajectory" />
              <TextBlock x:Name="TableRowCountDisplay"
                         Text="Rows: 0"
                         VerticalAlignment="Center"
                         Margin="20,0,0,0" />
            </StackPanel>
          </StackPanel>

          <!-- Table -->
          <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Margin="10,0,10,10">
            <controls:TrajectoryTableControl x:Name="TrajectoryTable" />
          </Border>

          <!-- Info Panel -->
          <Border Grid.Row="2" Background="LightGray" Padding="10" Margin="10,0,10,10">
            <TextBlock x:Name="TableInfoDisplay"
                       Text="Click 'Load Sample Trajectory' to display a table. Change units/angular/click settings to see on-demand formatting in action."
                       TextWrapping="Wrap" />
          </Border>
        </Grid>
      </TabItem>

      <!-- Font Size Control Tab -->
      <TabItem Header="Font Size Test">
        <StackPanel Margin="20" Spacing="15">
          <TextBlock Text="Programmatic Font Size Control"
                     FontWeight="Bold"
                     Margin="0,0,0,10"/>

          <TextBlock Text="Current app-wide font size can be changed programmatically:"
                     TextWrapping="Wrap" />

          <StackPanel Orientation="Horizontal" Spacing="10">
            <Button Content="Font Size: 10" Click="OnSetFontSize10" />
            <Button Content="Font Size: 12" Click="OnSetFontSize12" />
            <Button Content="Font Size: 13 (Default)" Click="OnSetFontSize13" />
            <Button Content="Font Size: 14" Click="OnSetFontSize14" />
            <Button Content="Font Size: 16" Click="OnSetFontSize16" />
          </StackPanel>

          <Border Background="LightGray" Padding="10" CornerRadius="3" Margin="0,10,0,0">
            <TextBlock x:Name="FontSizeDisplay"
                       Text="Current font size: 13"
                       FontWeight="Bold" />
          </Border>

          <TextBlock Text="Sample Controls:" FontWeight="Bold" Margin="0,20,0,0" />

          <StackPanel Spacing="10">
            <TextBlock Text="This is sample text that will resize." />

            <controls:BallisticCoefficientControl
                x:Name="FontTestBC"
                Width="300"
                HorizontalAlignment="Left" />

            <Button Content="Sample Button" />

            <TextBox Text="Sample TextBox" Width="200" HorizontalAlignment="Left" />
          </StackPanel>
        </StackPanel>
      </TabItem>
    </TabControl>

</Window>
